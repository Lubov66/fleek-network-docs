"use strict";(self.webpackChunkdocta=self.webpackChunkdocta||[]).push([[7147],{5450:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>d,toc:()=>l});var r=i(5893),s=i(1151),t=i(3872);const o={title:"Permission denied (os error 13)",slug:"permission-denied-os-error-13",hide_title:!0,tags:["permissions"]},a=void 0,d={id:"Lightning CLI/permission-denied-os-error-13",title:"Permission denied (os error 13)",description:"Ownership and file permissions",source:"@site/references/Lightning CLI/permission-denied-os-error-13.md",sourceDirName:"Lightning CLI",slug:"/Lightning CLI/permission-denied-os-error-13",permalink:"/references/Lightning CLI/permission-denied-os-error-13",draft:!1,unlisted:!1,editUrl:"https://github.com/fleek-network/fleek-network-docs/edit/main/references/Lightning CLI/permission-denied-os-error-13.md",tags:[{label:"permissions",permalink:"/references/tags/permissions"}],version:"current",lastUpdatedAt:1705073752,formattedLastUpdatedAt:"Jan 12, 2024",frontMatter:{title:"Permission denied (os error 13)",slug:"permission-denied-os-error-13",hide_title:!0,tags:["permissions"]},sidebar:"defaultSidebar",previous:{title:"Node secret key does not exist",permalink:"/references/Lightning CLI/node-secret-key-does-not-exist"},next:{title:"Restore the keystore",permalink:"/references/Lightning CLI/restore-the-keystore"}},c={},l=[{value:"Ownership and file permissions",id:"ownership-and-file-permissions",level:2},{value:"Override the TMPDIR",id:"override-the-tmpdir",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"ownership-and-file-permissions",children:"Ownership and file permissions"}),"\n",(0,r.jsxs)(n.p,{children:["When running the Lightning CLI, the user who's in control can delegate to ",(0,r.jsx)(n.strong,{children:"root"})," via ",(0,r.jsx)(n.strong,{children:"sudo"}),". Depending on how the Fleek Networking Lightning CLI was installed, this might cause some confusion, which is better explained by reading the reference ",(0,r.jsx)(n.a,{href:"/references/Lightning%20CLI/keys-not-found",children:"Keys not found"}),", which illustrates a situation where a user gets an error message about the wrong location of a system path (keystore)."]}),"\n",(0,r.jsxs)(n.p,{children:["Some reasons why the ",(0,r.jsx)(n.code,{children:"Permission denied (os error 13)"})," might occur are related to:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The Fleek Network Lightning CLI process trying to write to a ",(0,r.jsx)(n.code,{children:".lightning"})," stored in a non permitted location"]}),"\n",(0,r.jsxs)(n.li,{children:["The Fleek Network Lightning CLI process trying to write to ",(0,r.jsx)(n.code,{children:"/tmp"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The most common issue can be fixed by reading the section ",(0,r.jsx)(n.a,{href:"#override-the-tmpdir",children:"Override the TMPDIR"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"override-the-tmpdir",children:"Override the TMPDIR"}),"\n",(0,r.jsx)(n.p,{children:"The Fleek Network Lightning process requires writing to a temporary directory. As the process requires permissions, this might fail as demonstrated by some of the output logs we have below."}),"\n",(0,r.jsx)(n.p,{children:"a) A permission denied error message"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"Permission denied (os error 13)\n"})}),"\n",(0,r.jsx)(n.p,{children:"b) Rust panic error message which includes a permission denied"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"thread 'main' panicked at 'called Result::unwrap() on an Err value: Os { code: 13, kind: PermissionDenied, message: \"Permission denied\" }', core/node/src/cli.rs:181:18\nnote: run with RUST_BACKTRACE=1 environment variable to display a backtrace\nthread 'main' panicked at 'called Result::unwrap() on an Err value: Os { code: 13, kind: PermissionDenied, message: \"Permission denied\" }', core/node/src/cli.rs:181:18\nnote: run with RUST_BACKTRACE=1 environment variable to display a backtrace\nthread 'main' panicked at 'called Result::unwrap() on an Err value: Os { code: 13, kind: PermissionDenied, message: \"Permission denied\" }', core/node/src/cli.rs:181:18\nnote: run with RUST_BACKTRACE=1 environment variable to display a backtrace\nthread 'main' panicked at 'called Result::unwrap() on an Err value: Os { code: 13, kind: PermissionDenied, message: \"Permission denied\" }', core/node/src/cli.rs:181:18\nnote: run with RUST_BACKTRACE=1 environment variable to display a backtrace\nthread 'main' panicked at 'called Result::unwrap() on an Err value: Os { code: 13, kind: PermissionDenied, message: \"Permission denied\" }', core/node/src/cli.rs:181:18\nnote: run with RUST_BACKTRACE=1 environment variable to display a backtrace\n"})}),"\n",(0,r.jsx)(n.p,{children:"c) A trace showing the path where this has failed"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'[00007fcbe168e764] openat(AT_FDCWD, "/tmp/lightning.log", O_WRONLY|O_CREAT|O_APPEND|O_CLOEXEC, 0666) = -1 EACCES (Permission denied)\n[00007fcbe168ea6f] write(2, "thread \'", 8thread \') = 8\n[00007fcbe168ea6f] write(2, "main", 4main)  = 4\n[00007fcbe168ea6f] write(2, "\' panicked at \'", 15\' panicked at \') = 15\n[00007fcbe168ea6f] write(2, "called `Result::unwrap()` on an "..., 114called `Result::unwrap()` on an `Err` value: Os { code: 13, kind: PermissionDenied, message: "Permission denied" }) = 114\n[00007fcbe168ea6f] write(2, "\', ", 3\', )   = 3\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"/tmp"})," directory should have wide permissions for all applications, but to mitigate any permission issues the user can override the system environment ",(0,r.jsx)(n.code,{children:"TMPDIR"}),". For example, the ",(0,r.jsx)(n.code,{children:"installer"})," and ",(0,r.jsx)(n.code,{children:"update"})," scripts override ",(0,r.jsx)(n.code,{children:"TMPDIR"})," environment variable to ",(0,r.jsx)(n.code,{children:"/var/tmp"})," setting it in the service unit ",(0,r.jsx)(n.code,{children:"Environment="}),"."]})}),"\n",(0,r.jsxs)(n.p,{children:["The Lightning CLI process is aware of the environment variable TMPDIR, which the operators can override as discussed in the reference for ",(0,r.jsx)(n.a,{href:"/references/Lightning%20CLI/update-cli-from-source-code/#update-the-systemd-service-unit",children:"Update the System service unit"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["In short, it requires you to include a ",(0,r.jsx)(n.code,{children:"Environment="})," value of ",(0,r.jsx)(n.code,{children:"TMPDIR=/var/tmp"})," as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"[Service]\n...\nStandardOutput=append:/var/log/lightning/output.log\nStandardError=append:/var/log/lightning/diagnostic.log\nEnvironment=TMPDIR=/var/tmp\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"attention",type:"caution",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"/etc/systemd/system/lightning.service"})," service unit file presented here is a shorter version for simplicity. Do not replace your service unit file with the shorter content version presented here."]})}),"\n",(0,r.jsx)(t.Z,{name:"Helder Oliveira",image:"https://github.com/heldrida.png",title:"Software Developer + DX",url:"https://github.com/heldrida"})]})}function m(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},3872:(e,n,i)=>{i.d(n,{Z:()=>s});i(7294);var r=i(5893);const s=e=>{let{image:n,name:i,title:s,url:t,communityMember:o=!1}=e;return(0,r.jsx)("section",{className:"author_card",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"avatar",children:(0,r.jsx)("a",{href:t,target:"_blank",alt:i,children:(0,r.jsx)("img",{src:n,alt:i})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"name",children:(0,r.jsx)("a",{href:t,target:"_blank",alt:i,children:i})}),(0,r.jsx)("span",{className:"title",children:s}),(0,r.jsxs)("span",{className:"discord",children:[o?"Join our community on":"Got questions? Find us on"," ",(0,r.jsx)("a",{href:"https://discord.gg/fleek",target:"_blank",children:"discord!"})]})]})]})})}},1151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>o});var r=i(7294);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);